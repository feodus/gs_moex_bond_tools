# MOEX Bond Data for Google Sheets

Библиотека Google Apps Script для получения данных по облигациям с Московской Биржи (MOEX) в реальном времени прямо в Google Таблицы.

## Возможности

Скрипт предоставляет набор кастомных функций для использования в ячейках таблицы:

### Основные функции

- `=GET_MOEX_PRICE("TICKER")` — Текущая цена облигации (в % от номинала)
- `=GET_MOEX_NAME("TICKER")` — Краткое наименование облигации
- `=GET_NEXT_COUPON("TICKER")` — Дата следующего купона
- `=GET_COUPON_VALUE("TICKER")` — Размер следующего купона (в рублях)
  - _Поддерживает флоатеры_: если купон еще не определен, пытается найти последнее известное значение
- `=GET_MATURITY_DATE("TICKER")` — Дата погашения облигации

### Дополнительные возможности

- **Кэширование**: Результаты запросов кэшируются для оптимизации производительности и соблюдения лимитов API MOEX:
  - Цены: 5 минут
  - Дата купона: 6 часов
  - Название и дата погашения: 24 часа
  - Размер купона: 6 часов
- **Массовое обновление**: Меню "MOEX" → "Обновить все данные (с задержкой)" позволяет принудительно пересчитать все формулы с задержкой 400мс между ячейками, чтобы избежать ошибок "Too Many Requests"

## Установка

1.  Откройте вашу Google Таблицу.
2.  Перейдите в меню **Расширения** > **Apps Script**.
3.  Скопируйте содержимое файла `script.js` из этого репозитория в редактор кода.
4.  Нажмите **Сохранить** (иконка дискеты).
5.  Вернитесь в таблицу и обновите страницу. Появится меню "MOEX" (может потребоваться несколько секунд).

## Использование

Просто используйте функции как обычные формулы Excel/Google Sheets:

```excel
=GET_MOEX_PRICE("SU26227RMFS7")
=GET_MOEX_NAME("SU26227RMFS7")
=GET_NEXT_COUPON("SU26227RMFS7")
=GET_COUPON_VALUE("SU26227RMFS7")
=GET_MATURITY_DATE("SU26227RMFS7")
```

Где `SU26227RMFS7` — это ISIN код облигации (например, ОФЗ 26227).

## Лицензия

Этот проект распространяется под лицензией MIT. Подробности см. в файле [LICENSE](LICENSE).
