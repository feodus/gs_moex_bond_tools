# MOEX Bond Data for Google Sheets

Библиотека Google Apps Script для получения данных по облигациям с Московской Биржи (MOEX) в реальном времени прямо в Google Таблицы.

## Возможности

Скрипт предоставляет набор кастомных функций для использования в ячейках таблица:

- `=GET_MOEX_PRICE("TIKER")` — Текущая цена облигации (% от номинала).
- `=GET_NEXT_COUPON("TIKER")` — Дата следующего купона.
- `=GET_COUPON_VALUE("TIKER")` — Размер следующего купона (в рублях).
  - _Поддерживает флоатеры_: если купон еще не определен, пытается найти последнее известное значение.
- `=GET_MOEX_NAME("TIKER")` — Краткое наименование облигации.

### Дополнительно

- **Кэширование**: Результаты запросов кэшируются (цены на 5 минут, статические данные на 6-24 часа) для соблюдения лимитов API MOEX и ускорения работы.
- **Массовое обновление**: Меню "MOEX" -> "Обновить все цены" позволяет принудительно пересчитать все формулы с задержкой, чтобы избежать ошибок "Too Many Requests".

## Установка

1.  Откройте вашу Google Таблицу.
2.  Перейдите в меню **Расширения** > **Apps Script**.
3.  Скопируйте содержимое файла `script.js` из этого репозитория в редактор кода.
4.  Нажмите **Сохранить** (иконка дискеты).
5.  Вернитесь в таблицу и обновите страницу. Появится меню "MOEX" (может потребоваться несколько секунд).

## Использование

Просто используйте функции как обычные формулы Excel/Google Sheets:

```excel
=GET_MOEX_PRICE("SU26227RMFS7")
=GET_NEXT_COUPON("SU26227RMFS7")
```

Где `SU26227RMFS7` — это тикер (код) облигации (например, ОФЗ 26227).

## Лицензия

Этот проект распространяется под лицензией MIT. Подробности см. в файле [LICENSE](LICENSE).
